{"version":3,"file":"shuffle-text.module.js","sources":["../src/ShuffleText.ts"],"sourcesContent":["/*\n * ShuffleText by Yasunobu Ikeda. Feb 3, 2012\n * Visit http://clockmaker.jp/ for documentation, updates and examples.\n *\n *\n * Copyright (c) 2012-2017 Yasunobu Ikeda\n *\n * Permission is hereby granted, free of charge, to any person\n * obtaining a copy of this software and associated documentation\n * files (the \"Software\"), to deal in the Software without\n * restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following\n * conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n * OTHER DEALINGS IN THE SOFTWARE.\n */\n\n/**\n * ShuffleText is random text effect class for DOM Elements.\n * ShuffleTextはDOMエレメント用ランダムテキストクラスです。\n * @author Yasunobu Ikeda\n */\nexport class ShuffleText {\n\n  /** The string for random text. ランダムテキストに用いる文字列です。 */\n  public sourceRandomCharacter: string = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890';\n  /** The string for effect space. 空白に用いる文字列です。 */\n  public emptyCharacter: string = '-';\n  /** It is running flag. 再生中かどうかを示すブール値です。 */\n  public isRunning: boolean = false;\n  /** The milli seconds of effect time. エフェクトの実行時間です。 */\n  public duration: number = 600;\n  private _originalStr: string = '';\n  private _originalLength: number = 0;\n  private _timeCurrent: number = 0;\n  private _timeStart: number = 0;\n  private _randomIndex: number[] = [];\n  private _element: HTMLElement;\n\n  /**\n   * Constructor.\n   * @param element DOMエレメント\n   */\n  constructor(element: HTMLElement) {\n    this._element = element;\n    this.setText(element.innerHTML);\n  }\n\n  /** テキストを設定します。 */\n  public setText(text: string): void {\n    this._originalStr = text;\n    this._originalLength = text.length;\n  }\n\n  /** 再生を開始します。 */\n  public start(): void {\n    this.stop();\n\n    this._randomIndex = [];\n    let str = '';\n    for (let i = 0; i < this._originalLength; i++) {\n      let rate = i / this._originalLength;\n      this._randomIndex[i] = Math.random() * (1 - rate) + rate;\n      str += this.emptyCharacter;\n    }\n\n    this._timeStart = new Date().getTime();\n    this.isRunning = true;\n\n    requestAnimationFrame(() => {\n      this._onInterval();\n    });\n\n    this._element.innerHTML = str;\n  }\n\n  /** 停止します。 */\n  public stop(): void {\n    this.isRunning = false;\n  }\n\n  /**\n   * インターバルハンドラーです。\n   * @private\n   */\n  private _onInterval(): void {\n    this._timeCurrent = new Date().getTime() - this._timeStart;\n    const percent = this._timeCurrent / this.duration;\n\n    let str = '';\n    for (let i = 0; i < this._originalLength; i++) {\n      if (percent >= this._randomIndex[i]) {\n        str += this._originalStr.charAt(i);\n      } else if (percent < this._randomIndex[i] / 3) {\n        str += this.emptyCharacter;\n      } else {\n        str += this.sourceRandomCharacter.charAt(Math.floor(Math.random() * (this.sourceRandomCharacter.length)));\n      }\n    }\n\n    if (percent > 1) {\n      str = this._originalStr;\n      this.isRunning = false;\n    }\n    this._element.innerHTML = str;\n\n    if (this.isRunning === true) {\n      requestAnimationFrame(() => {\n        this._onInterval();\n      });\n    }\n  }\n}\n"],"names":[],"mappings":"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"}